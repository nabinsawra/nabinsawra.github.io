<!DOCTYPE html>
<html>
<head>
    <title>Community Data Entry (with Login, Photo Upload & Export)</title>
    <style>
    body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url(https://i.ibb.co/RT1NFpdD/images.jpg) no-repeat center center;
        background-size: 300px;
        opacity: 0.08;
        z-index: -1;
    }
    .photo-preview {
        width: 100px;
        height: 100px;
        object-fit: cover;
    }
    </style>
</head>
<body>

<h1>Community Data Entry (Secure Login)</h1>

<div id="loginSection">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button onclick="login()">Login</button>
    <p id="loginMessage" style="color:red;"></p>
</div>

<div id="logoutSection" style="display:none;">
    <button onclick="logout()">Logout</button>
</div>

<div id="dataSection" style="display:none;">
    <form id="dataForm">
        <label for="district">District:</label>
        <select id="district" required>
            <option value="">--Select District--</option>
        </select>

        <label for="village">Village:</label>
        <select id="village" required>
            <option value="">--Select Village--</option>
        </select>

        <label>Naam:</label>
        <input type="text" id="name" required>

        <label>Janam Tithi (DOB):</label>
        <input type="date" id="dob" required>

        <label>Population (default 1):</label>
        <input type="number" id="population" value="1" min="1">

        <label>Qualification:</label>
        <select id="qualification">
            <option value="Board of Secondary">Board of Secondary</option>
            <option value="Higher Secondary">Higher Secondary</option>
            <option value="Graduation">Graduation</option>
        </select>

        <label>Occupation:</label>
        <select id="occupation" required>
            <option value="">--Select Occupation--</option>
            <option value="Employed">Employed</option>
            <option value="Unemployed">Unemployed</option>
            <option value="Student">Student</option>
        </select>

        <label>Gender:</label>
        <select id="gender" required>
            <option value="">Select Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
        </select>

        <label>Upload Photo:</label>
        <input type="file" id="photo" accept="image/*" required>
        <img id="photoPreview" class="photo-preview" src="#" alt="Preview" style="display:none;">

        <label>Father's Name:</label>
        <input type="text" id="fatherName" required>

        <label>Mother's Name:</label>
        <input type="text" id="motherName" required>

        <label>Address:</label>
        <input type="text" id="address" required>

        <button type="submit" style="margin-top: 15px;">Add Entry</button>
    </form>

    <button id="showListBtn" style="margin-top: 20px;">Show List</button>
    <button id="hideListBtn" style="margin-top: 20px; display:none;">Hide List</button>

    <div id="filters">
        <label>Select District:</label>
        <select id="filterDistrict">
            <option value="">--Select District--</option>
            <option value="Sonitpur">Sonitpur</option>
            <option value="Udalguri">Udalguri</option>
            <option value="Dibrugarh">Dibrugarh</option>
        </select>

        <label>Select Village:</label>
        <select id="filterVillage">
            <option value="">--Select Village--</option>
        </select>
    </div>

    <div class="summary">
        <h2>Summary</h2>
        <p><strong>Total Population:</strong> <span id="totalPopulation">0</span></p>
        <p><strong>Qualification Count:</strong></p>
        <ul>
            <li>Board of Secondary: <span id="countSecondary">0</span></li>
            <li>Higher Secondary: <span id="countHigher">0</span></li>
            <li>Graduation: <span id="countGrad">0</span></li>
        </ul>
    </div>

    <button onclick="exportToExcel()">Export to Excel</button>
    <button onclick="generatePDF()">Download Summary PDF</button>

    <table id="dataTable">
        <thead>
            <tr>
                <th>District</th>
                <th>Village</th>
                <th>Name</th>
                <th>DOB</th>
                <th>Population</th>
                <th>Qualification</th>
                <th>Occupation</th>
                <th>Gender</th>
                <th>Photo</th>
                <th>Father's Name</th>
                <th>Mother's Name</th>
                <th>Address</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
<script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf"></script>

<script>
// Add JavaScript from previous photo/gender/preview/pdf logic here and integrate with current form submission and display.
</script>
</body>
</html>
